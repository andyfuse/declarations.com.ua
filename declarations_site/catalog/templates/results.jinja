{% extends "base.jinja" %}
{% from "_search_results.jinja" import search_results %}
{% from "_spotter.jinja" import spotter_button -%}

{% block extrahead %}
{% if results.has_previous() %}<link rel="prev" href="?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}" />{% endif %}
{% if results.has_next() %}<link rel="next" href="?{{ updated_querystring(request, {'page': results.next_page_number()}) }}" />{% endif %}
{% endblock %}

{% block html_desc %}{% if meta %}{{ meta.description }}{% else %}{{ super() }}{% endif %}{% endblock %}
{% block html_title %}{% if meta %}{{ meta.title }}{% else %}{{ super() }}{% endif %}{% endblock %}

{% block bodyclass %}not-front search-page{% endblock %}

{% block content %}
<section id="page">
    <div class="container">
        <div id="breadcrumbs">
            <ol class="breadcrumb">
                <li><a href="{{ url("wagtail_serve", "") }}">Головна</a></li>
                <li class="active">Результати пошуку</li>
            </ol>
            {{ social("Результати пошуку по: %s. " % query,
                              "http://declarations.com.ua%s" % request.path ,
                              add_disqus=False) }}
        </div>

        <div id="ex-search-form">
            <form class="box" action="{{ url("search") }}" method="GET">

                <div class="input-group search-string">
                    <input type="text" name="q" class="form-control search-name" id="search-form" placeholder="Наприклад: Айварас Абромавичус; Суддя; Хмельницька область; Державна фіскальна служба" autocomplete="off" value="{% if query %}{{ query }}{% endif %}" />
                    <span id="search_scope" class="input-group-btn">
                        <div class="checkbox"><label><input type="checkbox" name="deepsearch" {% if deepsearch %}checked="checked"{% endif %}> <span>Шукати скрізь</span></label></div>
                    </span>
                    <span class="input-group-btn">
                        <button class="btn btn-default" type="submit"> <span class="glyphicon glyphicon-search"></span> </button>
                    </span>
                </div>

                <div class="row">
                    <div class="col-sm-6 col-md-4 col col-1">
                        <!-- Рік -->
                        <div class="fieldset-container">
                            <fieldset>
                                <legend>Рік:</legend>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownYear" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    Рік:
                                    <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu dropdown-as-select" aria-labelledby="dropdownYear" data-linked-input="search-field-year">
                                        <li><a href="#" data-value="">Рік:</a></li>
                                        <li role="separator" class="divider"></li>
                                        <li><a href="#" data-value="2011">2011</a></li>
                                        <li><a href="#" data-value="2012">2012</a></li>
                                        <li><a href="#" data-value="2013">2013</a></li>
                                        <li><a href="#" data-value="2014">2014</a></li>
                                        <li><a href="#" data-value="2015">2015</a></li>
                                        <li><a href="#" data-value="2016">2016</a></li>
                                        <li><a href="#" data-value="2017">2017</a></li>
                                  </ul>
                                </div>
                                <input id="search-field-year" class="linked-input" type="hidden" value="2017" />
                            </fieldset>

                            <!-- Тип документу -->
                            <fieldset>
                                <legend>Тип документу:</legend>
                                <div class="dropdown">
                                    <button class="btn btn-default dropdown-toggle" type="button" id="dropdownDocType" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                    Тип документу:
                                    <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu dropdown-as-select" aria-labelledby="dropdownDocType" data-linked-input="search-field-doctype">
                                        <li><a href="#" data-value="">Тип документу:</a></li>
                                        <li role="separator" class="divider"></li>
                                        <li><a href="#" data-value="1">Річна</a></li>
                                        <li><a href="#" data-value="2">Перед звільненням</a></li>
                                        <li><a href="#" data-value="3">Після звільнення</a></li>
                                        <li><a href="#" data-value="4">Декларація кандидата</a></li>
                                        <li><a href="#" data-value="5">Форма змін</a></li>
                                    </ul>
                                </div>
                                <input id="search-field-doctype" class="linked-input" type="hidden" />
                            </fieldset>
                        </div>
                    </div>

                    <!-- Тип посади -->
                    <div class="col-sm-6 col-md-4 col col-2">
                        <fieldset>
                            <legend>Тип посади:</legend>
                            <span class="form-group">
                                <div class="checkbox">
                                    <label><input type="checkbox" name="search-field-position_type-1"><span>Посада державної служби</span></label>
                                </div>
                            </span>
                            <span class="form-group">
                                <div class="checkbox">
                                    <label><input type="checkbox" name="search-field-position_type-2"><span>Посада в органах місцевого самоврядування</span></label>
                                </div>
                            </span>
                            <span class="form-group">
                                <div class="checkbox">
                                    <label><input type="checkbox" name="search-field-position_type-3"><span>Посадова особа юридичної особи публічного права</span></label>
                                </div>
                            </span>
                        </fieldset>
                    </div>

                    <!-- Регіон -->
                    <div class="col-sm-6 col-md-4 col col-3">
                        <fieldset>
                            <legend>Регіон:</legend>
                            <div class="dropdown form-group">
                                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownRegion" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
                                Регіон:
                                <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu dropdown-as-select" aria-labelledby="dropdownDocType" data-linked-input="search-field-region">
                                    <li><a href="#" data-value="">Регіон:</a></li>
                                    <li role="separator" class="divider"></li>
                                    <li><a href="#" data-value="1">м. Київ</a></li>
                                    <li><a href="#" data-value="2">Дніпропетровська область</a></li>
                                    <li><a href="#" data-value="3">Харківська область</a></li>
                                    <li><a href="#" data-value="4">Львівська область</a></li>
                                    <li><a href="#" data-value="5">...</a></li>
                                </ul>
                            </div>
                            <input id="search-field-region" class="linked-input" type="hidden" />

                            <div class="form-group">
                              <div class="radio">
                                <label>
                                  <input type="radio" name="search-field-region_type" value="option1" checked="" id="search-field-region_type-1">
                                  Регіон прописки
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <input type="radio" name="search-field-region_type" value="option1" id="search-field-region_type-2">
                                  Регіон фактичного приживання
                                </label>
                              </div>
                              <div class="radio">
                                <label>
                                  <input type="radio" name="search-field-region_type" value="option1" id="search-field-region_type-3">
                                  Регіон задекларованної нерухомості
                                </label>
                              </div>
                            </div>
                        </fieldset>
                    </div>

                </div>

            </form>
        </div>

        <h1 id="page-header"><span>{{ query|default("Всі", true)|escape }} ({{ results.paginator.count }})</span>

        {{ spotter_button("Моніторити цей запит", request.META['QUERY_STRING'], "from-search") }}
        </h1>
        <div class="page-content">
            <div class="btn-group toggle-view">
                <a href="#" id="list" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th-list"></span> Списком
                </a>
                <a href="#" id="grid" class="btn btn-default btn-sm">
                    <span class="glyphicon glyphicon-th"></span> Картками
                </a>
            </div>

            <div class="toggle-search">
                <span>Сортувати:</span>
                    <div class="btn-group">
                        <a href="#" id="sort-year" class="btn btn-default btn-sm">Рік</a>
                        <a href="#" id="sort-date" class="btn btn-default btn-sm">Дата</a>
                        <a href="#" id="sort-name" class="btn btn-default btn-sm">П.І.Б.</a>
                  </div>
            </div>

            <div class="row list-group search-results">
                {{ search_results(results) }}
            </div>

            {% if results.paginator.num_pages > 1 %}
            <ul class="pagination">
                <li{% if not results.has_previous() %} class="disabled"{% endif %}><a href="{% if results.has_previous() %}?{{ updated_querystring(request, {'page': results.previous_page_number()}) }}{% endif %}">«</a></li>
                {% for page_num in results.contextual_page_range %}
                {% if page_num == None %}
                    <li class="disabled"><a href="#">&hellip;</a></li>
                {% else %}
                    <li{% if results.number == page_num %} class="active"{% endif %}><a href="?{{ updated_querystring(request, {'page': page_num}) }}">{{ page_num }}</a></li>
                {% endif %}
                {% endfor %}
                <li{% if not results.has_next() %} class="disabled"{% endif %}><a href="{% if results.has_next() %}?{{ updated_querystring(request, {'page': results.next_page_number()}) }}{% endif %}">»</a></li>
            </ul>
            {% endif %}
    </div>
</section>

{% endblock %}